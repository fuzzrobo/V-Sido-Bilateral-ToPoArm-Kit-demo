# 5.学習

## 学習可視化ツール
```
pip install --upgrade protobuf
pip install wandb
wandb login   
```

[Weights & Biases: AI開発者プラットフォーム](https://wandb.ai/site/ja/)
よりAPIキーを取得し貼り付けます

```
**************************
```


## パラメータ変更

実行前にtrainのパラメータを必要に応じて変更します。stepsの目安は30000、より良い結果を得るためには100000程度が望ましいです。プログラムのテストとして、最初は1000程度で実験することをおすすめします

```
# lerobot/src/lerobot/configs/train.py内

seed: int | None = 1000
# Number of workers for the dataloader.
num_workers: int = 8
batch_size: int = 4
steps: int = 30000
eval_freq: int = 1000
log_freq: int = 50
save_checkpoint: bool = True
# Checkpoint is saved every `save_freq` training iterations and after the last training step.
save_freq: int = 200
```

| パラメータ名 | 役割 | 意味 |
| --- | --- | --- |
| steps | 総ステップ数 | パラメータの更新回数 |
| batch_size | バッチサイズ | 1ステップあたりのデータ/軌道の数 |
| num_workers | サブプロセスの数 | cpu core の数 -2くらい |
| eval_freq | 評価エピソード実行間隔 | 一度学習を止めて、ポリシーの評価を行う。 |
| save_freq | モデルチェックポイントの保存間隔 | steps< save_freqだと保存されないので注意 |
| log_freq | ログの実行間隔 | ターミナルへのログの間隔 |
    

## 学習

```
cd lerobot/src
```

```
python lerobot/scripts/train.py \
  --dataset.repo_id=${HF_USER}/topo_test1014_2 \
  --policy.type=act \
  --policy.repo_id=${HF_USER}/topo_test1014_2 \
  --output_dir=outputs/train/act_topo_test1014_2 \
  --job_name=act_pick_topo_test1014_2 \
  --policy.device=cuda \
  --wandb.enable=false
```

学習データの削除を行う場合

```
cd lerobot/src/outputs/train
rm -rf topo_test1014_2
```
